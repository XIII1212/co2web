<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <meta charset="UTF-8" />
  <title>SkyAI æ™ºæ…§ä½ç¢³äº¤é€šç³»çµ±</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { font-family: sans-serif; background: #f4f7f8; margin: 0; }
    header { background: teal; color: white; padding: 1rem; text-align: center; position: relative; }
    section { padding: 1rem; }
    input, button, select { padding: 0.5rem; margin: 0.5rem 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: center; }
    .highlight { background-color: #d0f5d8; }
    #map { height: 400px; margin-top: 1rem; }
    #langSelect {
      position: absolute;
      top: 1rem;
      right: 1rem;
      padding: 0.3rem;
    }
    #calculatorPage {
      display: none;
      background: #e6f7e6;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 5px;
    }
  </style>
</head>
<body>
  <header>
    <h2 id="mainTitle">ğŸŒ SkyAI - æ™ºæ…§æ°¸çºŒäº¤é€šæ¨è–¦ç³»çµ±</h2>
    <select id="langSelect">
      <option value="zh">ç¹é«”ä¸­æ–‡</option>
      <option value="en">English</option>
    </select>
  </header>

  <section id="mainPage">
    <input id="start" placeholder="èµ·é»ï¼Œä¾‹å¦‚ å°ä¸­è»Šç«™" />
    <input id="end" placeholder="çµ‚é»ï¼Œä¾‹å¦‚ æ¡ƒåœ’åœ‹éš›æ©Ÿå ´" />
    <button id="searchBtn">è¦åŠƒè·¯ç·š</button>
    <br />
    <button id="toCalculatorBtn">â¡ï¸ å‰å¾€å€‹äººç¢³è¶³è·¡è¨ˆç®—å™¨</button>

    <section id="weatherTip">ğŸŒ è«‹è¼¸å…¥èµ·é»ä»¥æŸ¥è©¢å¤©æ°£å»ºè­°</section>
    <section id="ecoTips">ğŸŒ± æ°¸çºŒå°çŸ¥è­˜ï¼šæ¯å¤©å¤šèµ°è·¯ 1 å…¬é‡Œï¼Œæ¯é€±å¯æ¸›å°‘ 1 å…¬æ–¤ç¢³æ’</section>
    <section id="map">ğŸ—ºï¸ æ¨¡æ“¬åœ°åœ–</section>

    <section id="eduSection" style="background:#f0fff0; padding:1rem; margin:1rem 0; border-radius:5px;">
      <h3>ğŸ“š æ°¸çºŒäº¤é€šå°æ•™å®¤</h3>
      <div id="eduContent"></div>
    </section>

    <section>
      <h3 id="resultTitle">å»ºè­°çµæœ</h3>
      <div id="summary"></div>
      <div id="co2Tip"></div>
      <div id="extraTip" style="color:red; margin-top: 1rem;"></div>
      <table>
        <thead>
          <tr>
            <th id="thMode">äº¤é€šæ–¹å¼</th>
            <th id="thTime">æ™‚é–“</th>
            <th id="thSpeed">æ™‚é€Ÿ</th>
            <th id="thDistance">è·é›¢</th>
            <th id="thCO2">ç¢³æ’é‡</th>
          </tr>
        </thead>
        <tbody id="resultTable"></tbody>
      </table>
      <canvas id="co2Chart" style="max-width: 600px; margin: 1rem auto;"></canvas>
    </section>
  </section>

  <section id="calculatorPage">
    <h3>ğŸ§® å€‹äººç¢³è¶³è·¡è¨ˆç®—å™¨</h3>
    <label for="transportType">äº¤é€šå·¥å…·ï¼š</label>
    <select id="transportType">
      <option value="car">æ±½è»Š</option>
      <option value="motorcycle">æ©Ÿè»Š</option>
      <option value="bicycle">è…³è¸è»Š</option>
      <option value="transit">å¤§çœ¾é‹è¼¸</option>
      <option value="walking">æ­¥è¡Œ</option>
    </select><br />
    <label for="daysPerWeek">æ¯é€±ä½¿ç”¨å¤©æ•¸ï¼š</label>
    <input type="number" id="daysPerWeek" value="5" min="0" max="7" /><br />
    <label for="distancePerTrip">æ¯æ—¥å–®ç¨‹è·é›¢ï¼ˆå…¬é‡Œï¼‰ï¼š</label>
    <input type="number" id="distancePerTrip" value="5" min="0" /><br />
    <button id="calcCarbonBtn">è¨ˆç®—ç¢³æ’</button>
    <div id="carbonResult" style="margin-top:1rem; font-weight:bold;"></div>
    <button id="backToMainBtn" style="margin-top:1rem;">â¬…ï¸ è¿”å›ä¸»é </button>
  </section>

  <section id="subwayDirectTip" style="margin:0.5rem 0; font-weight:bold; color: blue;"></section>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="script.js"></script>
  <script>
    // ç°¡å–®åˆ‡æ›é é¢
    const mainPage = document.getElementById("mainPage");
    const calculatorPage = document.getElementById("calculatorPage");
    const toCalculatorBtn = document.getElementById("toCalculatorBtn");
    const backToMainBtn = document.getElementById("backToMainBtn");
    const carbonResult = document.getElementById("carbonResult");

    toCalculatorBtn.addEventListener("click", () => {
      mainPage.style.display = "none";
      calculatorPage.style.display = "block";
      carbonResult.textContent = "";
    });

    backToMainBtn.addEventListener("click", () => {
      calculatorPage.style.display = "none";
      mainPage.style.display = "block";
    });

    // ç°¡å–®ç¢³æ’è¨ˆç®—ä¿‚æ•¸ï¼ˆå–®ä½ï¼šå…‹CO2/kmï¼‰
    const carbonCoefficients = {
      car: 192,
      motorcycle: 103,
      bicycle: 0,
      transit: 45,
      walking: 0
    };

    document.getElementById("calcCarbonBtn").addEventListener("click", () => {
      const transportType = document.getElementById("transportType").value;
      const daysPerWeek = parseInt(document.getElementById("daysPerWeek").value);
      const distancePerTrip = parseFloat(document.getElementById("distancePerTrip").value);

      if (daysPerWeek < 0 || daysPerWeek > 7 || distancePerTrip < 0) {
        alert("è«‹è¼¸å…¥åˆç†çš„æ•¸å€¼ï¼");
        return;
      }

      // æ¯é€±ç¸½è·é›¢ = å¤©æ•¸ Ã— å–®ç¨‹è·é›¢ Ã— 2 (ä¾†å›)
      const weeklyDistance = daysPerWeek * distancePerTrip * 2;
      const co2PerKm = carbonCoefficients[transportType] || 0;

      const weeklyCO2 = weeklyDistance * co2PerKm; // å–®ä½ï¼šå…‹

      carbonResult.textContent = `æ¯é€±ç¢³æ’æ”¾é‡ç´„ ${weeklyCO2.toLocaleString()} å…‹ COâ‚‚`;
    });
  </script>
</body>
</html>